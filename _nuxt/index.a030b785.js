import{z as Y,A as j,l as S,s as q,u as D,q as _,o as v,c as f,F as A,h as F,j as $,B as u,C as H,f as J,t as L,v as N}from"./entry.c67c66b7.js";const P=["data-index"],U=Y({__name:"masonry-wall",props:{columnWidth:{default:400},items:{},gap:{default:0},rtl:{type:Boolean,default:!1},ssrColumns:{default:0},scrollContainer:{default:null},minColumns:{},maxColumns:{},keyMapper:{type:Function,default:(o,i,h,s)=>s}},emits:["redraw","redrawSkip"],setup(o,{emit:i}){const h=o,{columnWidth:s,items:r,gap:c,rtl:C,ssrColumns:w,scrollContainer:k,minColumns:x,maxColumns:g,keyMapper:E}=j(h),d=S([]),m=S();function B(n,e,t,l){const a=b(t);return l+e+a<=n?B(n,e,t+1,l+e+a):t}function b(n){const e=Array.isArray(s.value)?s.value:[s.value];return e[n%e.length]}function T(){const n=B(m.value.getBoundingClientRect().width,c.value,0,-c.value),e=O(W(n));return e>0?e:1}function W(n){const e=g==null?void 0:g.value;return e&&n>e?e:n}function O(n){const e=x==null?void 0:x.value;return e&&n<e?e:n}function z(n){return[...new Array(n)].map(()=>[])}if(w.value>0){const n=z(w.value);r.value.forEach((e,t)=>n[t%w.value].push(t)),d.value=n}async function M(n){if(n>=r.value.length)return;await N();const e=[...m.value.children];C.value&&e.reverse();const t=e.reduce((l,a)=>a.getBoundingClientRect().height<l.getBoundingClientRect().height?a:l);d.value[+t.dataset.index].push(n),await M(n+1)}async function p(n=!1){if(d.value.length===T()&&!n){i("redrawSkip");return}d.value=z(T());const e=k==null?void 0:k.value,t=e?e.scrollTop:window.scrollY;await M(0),e?e.scrollBy({top:t-e.scrollTop}):window.scrollTo({top:t}),i("redraw")}const y=typeof ResizeObserver>"u"?void 0:new ResizeObserver(()=>p());return q(()=>{p(),y==null||y.observe(m.value)}),D(()=>y==null?void 0:y.unobserve(m.value)),_([r,C],()=>p(!0)),_([s,c,x,g],()=>p()),(n,e)=>(v(),f("div",{ref_key:"wall",ref:m,class:"masonry-wall",style:$({display:"flex",gap:`${u(c)}px`})},[(v(!0),f(A,null,F(d.value,(t,l)=>(v(),f("div",{key:l,class:"masonry-column","data-index":l,style:$({display:"flex","flex-basis":`${b(l)}px`,"flex-direction":"column","flex-grow":1,gap:`${u(c)}px`,height:["-webkit-max-content","-moz-max-content","max-content"],"min-width":0})},[(v(!0),f(A,null,F(t,(a,R)=>(v(),f("div",{key:u(E)(u(r)[a],l,R,a),class:"masonry-item"},[H(n.$slots,"default",{item:u(r)[a],column:l,row:R,index:a},()=>[J(L(u(r)[a]),1)])]))),128))],12,P))),128))],4))}}),G=(()=>{const o=U;return o.install=i=>{i.component("MasonryWall",o)},o})();export{G as P};
